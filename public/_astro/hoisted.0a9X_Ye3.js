import{b as u,c as d,h as p,d as b,M as r,m,z as h,g as E,i as O,j as s,k as I,n as v,o as N,q as P,r as C}from"./main.bdTi7Vbw.js";import{c as T,U as n}from"./consts.xUzxqWeM.js";const z="http://localhost/portafolio/imagenes",c="http://localhost/portafolio";let f,i,a,l;T();document.addEventListener("DOMContentLoaded",function(){u.addEventListener("submit",_),D()});async function D(){try{if(U(),i===n.NUEVO_PROYECTO)F();else if(i===n.EDITAR_PROYECTO){d.textContent="Editar proyecto",p.textContent="Editar proyecto";const e=await b(f);$(e.resultado.proyecto)}}catch(e){let t;e instanceof r?t=JSON.parse(e.message):t=["Error"],m("error",C,t)}}function U(){let e=location.hash;if(e=e.slice(2),!e)throw new r(JSON.stringify(["Id del proyecto no especificado"]));let t=e.split("/");switch(t[t.length-1]===""&&t.pop(),t[0]){case n.EDITAR_PROYECTO:if(t.length!==2)throw new r(JSON.stringify(["Ruta no v치lida"]));break;case n.NUEVO_PROYECTO:if(t.length!==1)throw new r(JSON.stringify(["Ruta no v치lida"]));break;default:throw new r(JSON.stringify(["Operaci칩n no v치lida"]))}i=t[0],f=t[1]}function F(){d.textContent="Nuevo proyecto",p.textContent="Nuevo proyecto";const e=`${c}/img/no-img.png`;w(e,"no-imagen"),u.style.display="block"}async function $(e){const{titulo:t,descripcion:o,imagen:y,fechaProyecto:A}=e;h.setAttribute("value",t);let g=`${c}/img/no-img.png`;y.length&&(g=`${z}/${y}`);const R=`imagen de ${t}`;w(g,R),E.setAttribute("value",A),O.textContent=o,u.style.display="block"}function w(e,t){s.setAttribute("src",e),s.setAttribute("alt",`imagen de ${t}`),s.setAttribute("loading","lazy"),I.onchange=function(o){L(o.target.files[0])}}function L(e){if(!e){s.setAttribute("src",`${c}/img/no-img.png`),a={name:null,type:null,size:null},l=null;return}let t=new FileReader;t.readAsDataURL(e),t.onload=()=>{const o=t.result;l=o.replace(/^data:(.+)\/(.+);base64,/i,""),a=e,s.setAttribute("src",o)}}async function _(e){e.preventDefault();const t={titulo:h.value,descripcion:O.value,fechaProyecto:E.value};a&&(t.imagen={name:a.name,type:a.type,size:a.size,content:l}),i===n.NUEVO_PROYECTO?k(t):i===n.EDITAR_PROYECTO&&J(t)}async function k(e){try{const t=await v(e);window.location.href=`${c}/admin`}catch(t){let o;t instanceof r?o=JSON.parse(t.message):o=["Error"],m("error",P,o,"alerta-error-form")}}async function J(e){try{const t=await N(f,e);window.location.href=`${c}/admin`}catch(t){let o;t instanceof r?o=JSON.parse(t.message):o=["Error"],m("error",P,o,"alerta-error-form")}}
